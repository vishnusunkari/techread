{"componentChunkName":"component---src-templates-docs-js","path":"/concepts/02-maxLifetime","result":{"data":{"site":{"siteMetadata":{"title":"TechGry","docsLocation":""}},"mdx":{"fields":{"id":"87c6426b-26c8-53a8-866f-4c69b0e14772","title":"Fix HikariPool","slug":"/concepts/02-maxLifetime"},"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Fix HikariPool\",\n  \"metaTitle\": \"How to fix Failed to validate connection. Consider using a shorter maxLifetime value\",\n  \"metaDescription\": \"How to fix HikariPool Failed to validate connection Warning Errors within a SpringBoot Application, Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl, No operations allowed after connection closed,  Possibly consider using a shorter maxLifetime value\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h3\", null, \"How to fix \\\"HikariPool Failed to validate connection. Consider using a shorter maxLifetime value\\\"\"), mdx(\"p\", null, \"If you see the following errors in your SpringBoot Application:      \"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"com.zaxxer.hikari.pool.PoolBase: HikariPool-5 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@7ae6d507 \\n(No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.\\n\")), mdx(\"p\", null, \"Here are 2 ways you can fix :   \"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Increase the wait_timeout value on database server.   \")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Decrease the spring datasource's maxLifetime property to less than the database server's wait_timeout value.      \")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Check the wait_timeout value on mysql db server by running the following sql:\"))), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"mysql> show global variables like \\\"wait_timeout\\\";\\n----------------------------\\n| Variable_name  |  Value  |\\n----------------------------\\n|wait_timeout    |  28800  |\\n----------------------------\\n\")), mdx(\"p\", null, \"The above value 28800 is in seconds.  Compare it to the applications connection pool settings maxLifetime value which is in milliseconds.\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"In springboot the default value is 180000 milliseconds.\"), mdx(\"p\", null, \"You need to make sure the application properties default value is less than the database server's \\\"wait_timeout\\\" value.\"), mdx(\"p\", null, \"You can use the following mysql commands to update it.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"open mysql sudo service mysql start\\nopen command window\\n\\nsudo mysql -u username -p \\nchange the timeout\\n\\nSET @@GLOBAL.interactive_timeout=31536000\\nrestart server\\n\\nsudo service mysql restart\\n\")), mdx(\"ol\", {\n    \"start\": 2\n  }, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"If you don't want to mess with database server's values, here is the second option.\\nIn some cases the database server's value is shortened to make sure the database connections are closed much earlier   \")), mdx(\"p\", null, \"For eg: if the database server's wait_timeout value is 600 seconds which is equivalent to 600000 milliseconds as below    \"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"mysql> show global variables like \\\"wait_timeout\\\";\\n----------------------------\\n| Variable_name  |  Value  |\\n----------------------------\\n|wait_timeout    |   600   |\\n----------------------------\\n\")), mdx(\"p\", null, \"Need to find the spring.datasource property from your application.properties    \"), mdx(\"p\", null, \"For eg: if your datasource jdbc url is in the following format:   \"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"spring.billing-datasource.jdbcUrl=jdbc:mysql://prod-mariadb/billing\\n\")), mdx(\"p\", null, \"Then you need to have an additional property in the application.propertes for the above datasource as follows:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"spring.billing-datasource.maxLifetime=54000\\n\")), mdx(\"p\", null, \"Here 54000 is in milliseconds which is 30 secs less than the database server's \\\"wait_timeout\\\" which was 600000.       \"), mdx(\"p\", null, \"If you have multiple datasources defined in your application, you need to make sure the maxLifetime value is set\\nto all the datasources as defined above.   \"));\n}\n;\nMDXContent.isMDXComponent = true;","tableOfContents":{"items":[{"url":"#how-to-fix-hikaripool-failed-to-validate-connection-consider-using-a-shorter-maxlifetime-value","title":"How to fix \"HikariPool Failed to validate connection. Consider using a shorter maxLifetime value\""}]},"parent":{"__typename":"File","relativePath":"concepts/02-maxLifetime.mdx"},"frontmatter":{"metaTitle":"How to fix Failed to validate connection. Consider using a shorter maxLifetime value","metaDescription":"How to fix HikariPool Failed to validate connection Warning Errors within a SpringBoot Application, Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl, No operations allowed after connection closed,  Possibly consider using a shorter maxLifetime value"}},"allMdx":{"edges":[{"node":{"fields":{"slug":"/concepts","title":"RealWorld Concepts"}}},{"node":{"fields":{"slug":"/java","title":"Java"}}},{"node":{"fields":{"slug":"/aws","title":"AWS"}}},{"node":{"fields":{"slug":"/","title":"Technology Learning"}}},{"node":{"fields":{"slug":"/kafka","title":"Kafka Concepts"}}},{"node":{"fields":{"slug":"/kubernetes","title":"Kubernetes Concepts"}}},{"node":{"fields":{"slug":"/pages/about","title":"About TechGry"}}},{"node":{"fields":{"slug":"/pages/terms-and-conditions","title":"Terms and Conditions"}}},{"node":{"fields":{"slug":"/pages/about-me","title":"Vishnu Sunkari"}}},{"node":{"fields":{"slug":"/pages/disclaimer","title":"Disclaimer"}}},{"node":{"fields":{"slug":"/kafka/00-what-is-kafka","title":"What is Kafka"}}},{"node":{"fields":{"slug":"/pages/privacypolicy","title":"Privacy Policy"}}},{"node":{"fields":{"slug":"/kafka/02-kafka-brokers","title":"Brokers"}}},{"node":{"fields":{"slug":"/kubernetes/01-more-pods-on-nodes","title":"How to deploy more pods on kubernetes nodes"}}},{"node":{"fields":{"slug":"/kafka/03-kafka-producers","title":"Producers"}}},{"node":{"fields":{"slug":"/kafka/04-kafka-consumers","title":"Kafka Consumers"}}},{"node":{"fields":{"slug":"/kafka/01-kafka-topics-partitions-offsets","title":"Topics,Partitions & Offsets"}}},{"node":{"fields":{"slug":"/kafka/05-kafka-consumer-offsets-delivery","title":"Consumer Offsets and Delivery Semantics"}}},{"node":{"fields":{"slug":"/kafka/09-kafka-how-to-build-distributed-scalable-system","title":"How to build distributed scalable system with Kafka"}}},{"node":{"fields":{"slug":"/kafka/07-kafka-guarantees","title":"Kafka Guarantees"}}},{"node":{"fields":{"slug":"/kafka/08-kafka-concepts-summary","title":"Kafka Concepts Summary"}}},{"node":{"fields":{"slug":"/java/01-java-functional-programming","title":"Functional Programming"}}},{"node":{"fields":{"slug":"/kafka/06-kafka-broker-discovery-zookeeper","title":"Kafka Broker Discovery and Zookeeper"}}},{"node":{"fields":{"slug":"/java/00-java-classloaders","title":"Java ClassLoaders"}}},{"node":{"fields":{"slug":"/concepts/00-rotation-strategy","title":"Rotate Monthly"}}},{"node":{"fields":{"slug":"/concepts/01-apis-security","title":"API Security"}}},{"node":{"fields":{"slug":"/concepts/02-maxLifetime","title":"Fix HikariPool"}}},{"node":{"fields":{"slug":"/concepts/03-access-spring-beans","title":"Spring Beans"}}},{"node":{"fields":{"slug":"/concepts/04-save-queue-data-on-to-disk","title":"Saving Queue Data on to Disk"}}},{"node":{"fields":{"slug":"/aws/01-aws-organizations","title":"AWS Organizations"}}},{"node":{"fields":{"slug":"/aws/03-aws-service-catalog","title":"AWS Service Catalog"}}},{"node":{"fields":{"slug":"/aws/04-aws-systems-manager","title":"AWS Systems Manager"}}},{"node":{"fields":{"slug":"/aws/00-aws-iam","title":"IAM"}}},{"node":{"fields":{"slug":"/aws/02-aws-config","title":"AWS Config"}}},{"node":{"fields":{"slug":"/aws/05-aws-elastic-load-balancing","title":"Elastic Load Balancing"}}},{"node":{"fields":{"slug":"/aws/06-aws-autoscaling","title":"Autoscaling"}}},{"node":{"fields":{"slug":"/aws/07-aws-placement-groups","title":"Placement Groups"}}},{"node":{"fields":{"slug":"/aws/08-aws-cloudfront","title":"CloudFront"}}},{"node":{"fields":{"slug":"/aws/09-aws-route53","title":"Route53"}}},{"node":{"fields":{"slug":"/aws/10-aws-s3","title":"S3"}}},{"node":{"fields":{"slug":"/aws/11-aws-efs","title":"EFS"}}},{"node":{"fields":{"slug":"/aws/15-aws-elasticbeanstalk","title":"Elastic Beanstalk"}}},{"node":{"fields":{"slug":"/aws/14-aws-opsworks","title":"OpsWorks"}}},{"node":{"fields":{"slug":"/aws/13-aws-cloudformation","title":"CloudFormation"}}},{"node":{"fields":{"slug":"/aws/12-aws-rdsaurora","title":"RDS Aurora"}}}]}},"pageContext":{"id":"87c6426b-26c8-53a8-866f-4c69b0e14772"}},"staticQueryHashes":["2619113677","2619113677","3706406642","3706406642","417421954","417421954"]}