{"componentChunkName":"component---src-templates-docs-js","path":"/kubernetes/01-more-pods-on-nodes","result":{"data":{"site":{"siteMetadata":{"title":"TechGry","docsLocation":""}},"mdx":{"fields":{"id":"3f12827f-9342-50f9-9829-971e4a5cde6d","title":"How to deploy more pods on kubernetes nodes","slug":"/kubernetes/01-more-pods-on-nodes"},"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"How to deploy more pods on kubernetes nodes\",\n  \"metaTitle\": \"How to deploy more pods on kubernetes nodes ?\",\n  \"metaDescription\": \"How to deploy maximum number of pods on kubernetes nodes ? How to deploy more pods on EKS nodes ?  How to deploy more pods on kubernetes nodes ?\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h3\", null, \"How to deploy maximum number of pods on Kubernetes (EKS) nodes\"), mdx(\"p\", null, \"AWS EKS supports native VPC networking with the Amazon VPC Container Network Interface (CNI) plugin for Kubernetes.\\nUsing this plugin allows Kubernetes Pods to have the same IP address inside the pod as they do on the VPC network.\\nThe Amazon VPC CNI plugin for Kubernetes is deployed with each of your EC2 Nodes in a daemonset with the name aws-node.   \"), mdx(\"p\", null, \"This is a great feature, but it introduces a limitation in the number of pods per EC2 node. Whenever you deploy\\na pod in the EKS worker node, EKS creates a new IP address from VPC subnet and attach to the instance. You can find the\\nnumber of IP addresses per network interface per instance type in here:\\n\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-eni.html#AvailableIpPerENI\"\n  }, \"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-eni.html#AvailableIpPerENI\"), \"      \"), mdx(\"p\", null, \"In summary there are 3 limits that we need to be aware of:   \"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"The maximum theoretical limit is (3 ENIs \\xD7 (9 prefixes per ENI)* 16 IPs per prefix) = 432 pods   \"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"AWS has recommended limit: \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://github.com/awslabs/amazon-eks-ami/blob/master/files/eni-max-pods.txt\"\n  }, \"https://github.com/awslabs/amazon-eks-ami/blob/master/files/eni-max-pods.txt\"), \"   \"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Kubernetes has a recommended limit: \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://github.com/kubernetes/community/blob/master/sig-scalability/configs-and-limits/thresholds.md\"\n  }, \"https://github.com/kubernetes/community/blob/master/sig-scalability/configs-and-limits/thresholds.md\"), \"   \")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"For example:      \\n|                             | m5.4xlarge | m5.xlarge |\\n|-----------------------------|------------|-----------|\\n|AWS Recommended Limit        |     234    |     58    |\\n|Kubernetes Recommended Limit |     110    |    110    |\\n\")), mdx(\"p\", null, \"Because of the above CNI limitation EKS always restricts the max pods to just 110 for m5.4xlarge node. But with newer versions of eksctl there is a\\nconfiguration param for maxPodsPerNode - \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://eksctl.io/usage/eks-managed-nodes/\"\n  }, \"https://eksctl.io/usage/eks-managed-nodes/\"), \" (search page for maxPodsPerNode ).\\nand we could push it beyond what\\u2019s available to 234 pods.  Below is a sample of your cluster config manifest file with maxPodsPerNode\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"apiVersion: eksctl.io/v1alpha5\\nkind: ClusterConfig\\n\\nmetadata:\\n  name: dev-cluster\\n  region: ap-northeast-1\\n  version: \\\"1.23\\\"\\n  tags:\\n    \\\"Stage\\\": \\\"dev\\\"\\n    \\\"Type\\\": \\\"eks\\\"\\n\\nmanagedNodeGroups:\\n  - name: generalCompute-4\\n    instanceType: m5.4xlarge\\n    minSize: 3\\n    maxSize: 20\\n    maxPodsPerNode: 234\\n    desiredCapacity: 3\\n    volumeSize: 200\\n    updateConfig:\\n      maxUnavailablePercentage: 10\\n    \\n\")));\n}\n;\nMDXContent.isMDXComponent = true;","tableOfContents":{"items":[{"url":"#how-to-deploy-maximum-number-of-pods-on-kubernetes-eks-nodes","title":"How to deploy maximum number of pods on Kubernetes (EKS) nodes"}]},"parent":{"__typename":"File","relativePath":"kubernetes/01-more-pods-on-nodes.mdx"},"frontmatter":{"metaTitle":"How to deploy more pods on kubernetes nodes ?","metaDescription":"How to deploy maximum number of pods on kubernetes nodes ? How to deploy more pods on EKS nodes ?  How to deploy more pods on kubernetes nodes ?"}},"allMdx":{"edges":[{"node":{"fields":{"slug":"/concepts","title":"RealWorld Concepts"}}},{"node":{"fields":{"slug":"/java","title":"Java"}}},{"node":{"fields":{"slug":"/aws","title":"AWS"}}},{"node":{"fields":{"slug":"/kafka","title":"Kafka Concepts"}}},{"node":{"fields":{"slug":"/kubernetes","title":"Kubernetes Concepts"}}},{"node":{"fields":{"slug":"/pages/about","title":"About TechGry"}}},{"node":{"fields":{"slug":"/pages/terms-and-conditions","title":"Terms and Conditions"}}},{"node":{"fields":{"slug":"/pages/about-me","title":"Vishnu Sunkari"}}},{"node":{"fields":{"slug":"/pages/disclaimer","title":"Disclaimer"}}},{"node":{"fields":{"slug":"/kafka/00-what-is-kafka","title":"What is Kafka"}}},{"node":{"fields":{"slug":"/pages/privacypolicy","title":"Privacy Policy"}}},{"node":{"fields":{"slug":"/kafka/02-kafka-brokers","title":"Brokers"}}},{"node":{"fields":{"slug":"/kubernetes/01-more-pods-on-nodes","title":"How to deploy more pods on kubernetes nodes"}}},{"node":{"fields":{"slug":"/kafka/03-kafka-producers","title":"Producers"}}},{"node":{"fields":{"slug":"/kafka/04-kafka-consumers","title":"Kafka Consumers"}}},{"node":{"fields":{"slug":"/kafka/01-kafka-topics-partitions-offsets","title":"Topics,Partitions & Offsets"}}},{"node":{"fields":{"slug":"/kafka/05-kafka-consumer-offsets-delivery","title":"Consumer Offsets and Delivery Semantics"}}},{"node":{"fields":{"slug":"/kafka/09-kafka-how-to-build-distributed-scalable-system","title":"How to build distributed scalable system with Kafka"}}},{"node":{"fields":{"slug":"/kafka/07-kafka-guarantees","title":"Kafka Guarantees"}}},{"node":{"fields":{"slug":"/kafka/08-kafka-concepts-summary","title":"Kafka Concepts Summary"}}},{"node":{"fields":{"slug":"/java/01-java-functional-programming","title":"Functional Programming"}}},{"node":{"fields":{"slug":"/kafka/06-kafka-broker-discovery-zookeeper","title":"Kafka Broker Discovery and Zookeeper"}}},{"node":{"fields":{"slug":"/java/00-java-classloaders","title":"Java ClassLoaders"}}},{"node":{"fields":{"slug":"/concepts/00-rotation-strategy","title":"Rotate Monthly"}}},{"node":{"fields":{"slug":"/concepts/01-apis-security","title":"API Security"}}},{"node":{"fields":{"slug":"/concepts/02-maxLifetime","title":"Fix HikariPool"}}},{"node":{"fields":{"slug":"/concepts/03-access-spring-beans","title":"Spring Beans"}}},{"node":{"fields":{"slug":"/concepts/04-save-queue-data-on-to-disk","title":"Saving Queue Data on to Disk"}}},{"node":{"fields":{"slug":"/aws/01-aws-organizations","title":"AWS Organizations"}}},{"node":{"fields":{"slug":"/aws/03-aws-service-catalog","title":"AWS Service Catalog"}}},{"node":{"fields":{"slug":"/aws/04-aws-systems-manager","title":"AWS Systems Manager"}}},{"node":{"fields":{"slug":"/aws/00-aws-iam","title":"IAM"}}},{"node":{"fields":{"slug":"/aws/02-aws-config","title":"AWS Config"}}},{"node":{"fields":{"slug":"/aws/05-aws-elastic-load-balancing","title":"Elastic Load Balancing"}}},{"node":{"fields":{"slug":"/aws/06-aws-autoscaling","title":"Autoscaling"}}},{"node":{"fields":{"slug":"/aws/07-aws-placement-groups","title":"Placement Groups"}}},{"node":{"fields":{"slug":"/aws/08-aws-cloudfront","title":"CloudFront"}}},{"node":{"fields":{"slug":"/aws/09-aws-route53","title":"Route53"}}},{"node":{"fields":{"slug":"/aws/10-aws-s3","title":"S3"}}},{"node":{"fields":{"slug":"/aws/11-aws-efs","title":"EFS"}}},{"node":{"fields":{"slug":"/aws/15-aws-elasticbeanstalk","title":"Elastic Beanstalk"}}},{"node":{"fields":{"slug":"/aws/14-aws-opsworks","title":"OpsWorks"}}},{"node":{"fields":{"slug":"/aws/13-aws-cloudformation","title":"CloudFormation"}}},{"node":{"fields":{"slug":"/aws/12-aws-rdsaurora","title":"RDS Aurora"}}},{"node":{"fields":{"slug":"/security","title":"Security"}}},{"node":{"fields":{"slug":"/security/01-aws-private-ca-private-key","title":"AWS Private CA Private Key"}}},{"node":{"fields":{"slug":"/","title":"Technology Learning"}}},{"node":{"fields":{"slug":"/kubernetes/02-kubecost-integration-with-kubernetes","title":"What is Kubecost and how to integrate kubecost with kubernetes"}}}]}},"pageContext":{"id":"3f12827f-9342-50f9-9829-971e4a5cde6d"}},"staticQueryHashes":["2619113677","2619113677","3706406642","3706406642","417421954","417421954"]}